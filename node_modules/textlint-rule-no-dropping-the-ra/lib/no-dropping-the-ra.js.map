{"version":3,"sources":["../src/no-dropping-the-ra.js"],"names":["isTargetVerb","token","pos","pos_detail_1","conjugated_type","conjugated_form","isRaWord","basic_form","isSpecialCases","context","helper","RuleHelper","Syntax","report","getSource","RuleError","Str","node","isChildNode","Link","Image","BlockQuote","Emphasis","text","then","tokens","forEach","index","word_position","length","reduce","prev","current"],"mappings":"AAAA;AACA;;;;;;;AACA;;AACA;;AAEA,SAASA,YAAT,CAAsBC,KAAtB,EAA6B;AACzB,SACIA,KAAK,CAACC,GAAN,IAAa,IAAb,IACAD,KAAK,CAACE,YAAN,IAAsB,IADtB,IAEAF,KAAK,CAACG,eAAN,IAAyB,IAFzB,IAGAH,KAAK,CAACI,eAAN,IAAyB,KAJ7B;AAMH;;AAED,SAASC,QAAT,CAAkBL,KAAlB,EAAyB;AACrB,SAAOA,KAAK,CAACC,GAAN,IAAa,IAAb,IAAqBD,KAAK,CAACE,YAAN,IAAsB,IAA3C,IAAmDF,KAAK,CAACM,UAAN,IAAoB,IAA9E;AACH;;AAED,SAASC,cAAT,CAAwBP,KAAxB,EAA+B;AAC3B;AACA;AACA,SAAOA,KAAK,CAACC,GAAN,IAAa,IAAb,KAAsBD,KAAK,CAACM,UAAN,IAAoB,KAApB,IAA6BN,KAAK,CAACM,UAAN,IAAoB,KAAvE,CAAP;AACH;;AAEc,kBAAUE,OAAV,EAAmB;AAC9B,MAAMC,MAAM,GAAG,IAAIC,8BAAJ,CAAeF,OAAf,CAAf;AACA,MAAM;AAAEG,IAAAA,MAAF;AAAUC,IAAAA,MAAV;AAAkBC,IAAAA,SAAlB;AAA6BC,IAAAA;AAA7B,MAA2CN,OAAjD;AACA,SAAO;AACH,KAACG,MAAM,CAACI,GAAR,EAAaC,IAAb,EAAmB;AACf,UAAIP,MAAM,CAACQ,WAAP,CAAmBD,IAAnB,EAAyB,CAACL,MAAM,CAACO,IAAR,EAAcP,MAAM,CAACQ,KAArB,EAA4BR,MAAM,CAACS,UAAnC,EAA+CT,MAAM,CAACU,QAAtD,CAAzB,CAAJ,EAA+F;AAC3F;AACH;;AACD,UAAMC,IAAI,GAAGT,SAAS,CAACG,IAAD,CAAtB;AACA,aAAO,yBAASM,IAAT,EAAeC,IAAf,CAAqBC,MAAD,IAAY;AACnCA,QAAAA,MAAM,CAACC,OAAP,CAAgBzB,KAAD,IAAW;AACtB,cAAIO,cAAc,CAACP,KAAD,CAAlB,EAA2B;AACvBY,YAAAA,MAAM,CACFI,IADE,EAEF,IAAIF,SAAJ,CAAc,gBAAd,EAAgC;AAC5BY,cAAAA,KAAK,EAAE1B,KAAK,CAAC2B;AADe,aAAhC,CAFE,CAAN;AAMH;AACJ,SATD,EADmC,CAWnC;;AACA,YAAIH,MAAM,CAACI,MAAP,IAAiB,CAArB,EAAwB;AACpB;AACH;;AACDJ,QAAAA,MAAM,CAACK,MAAP,CAAc,CAACC,IAAD,EAAOC,OAAP,KAAmB;AAC7B,cAAIhC,YAAY,CAAC+B,IAAD,CAAZ,IAAsBzB,QAAQ,CAAC0B,OAAD,CAAlC,EAA6C;AACzCnB,YAAAA,MAAM,CACFI,IADE,EAEF,IAAIF,SAAJ,CAAc,gBAAd,EAAgC;AAC5BY,cAAAA,KAAK,EAAEK,OAAO,CAACJ,aAAR,GAAwB;AADH,aAAhC,CAFE,CAAN;AAMH;;AACD,iBAAOI,OAAP;AACH,SAVD;AAWH,OA1BM,CAAP;AA2BH;;AAjCE,GAAP;AAmCH;;AAAA","sourcesContent":["// LICENSE : MIT\n\"use strict\";\nimport { RuleHelper } from \"textlint-rule-helper\";\nimport { tokenize } from \"kuromojin\";\n\nfunction isTargetVerb(token) {\n    return (\n        token.pos == \"動詞\" &&\n        token.pos_detail_1 == \"自立\" &&\n        token.conjugated_type == \"一段\" &&\n        token.conjugated_form == \"未然形\"\n    );\n}\n\nfunction isRaWord(token) {\n    return token.pos == \"動詞\" && token.pos_detail_1 == \"接尾\" && token.basic_form == \"れる\";\n}\n\nfunction isSpecialCases(token) {\n    // Due to kuromoji.js's behavior, some dropping-ra words will be tokenized as one.\n    // See also https://github.com/takuyaa/kuromoji.js/issues/28\n    return token.pos == \"動詞\" && (token.basic_form == \"来れる\" || token.basic_form == \"見れる\");\n}\n\nexport default function (context) {\n    const helper = new RuleHelper(context);\n    const { Syntax, report, getSource, RuleError } = context;\n    return {\n        [Syntax.Str](node) {\n            if (helper.isChildNode(node, [Syntax.Link, Syntax.Image, Syntax.BlockQuote, Syntax.Emphasis])) {\n                return;\n            }\n            const text = getSource(node);\n            return tokenize(text).then((tokens) => {\n                tokens.forEach((token) => {\n                    if (isSpecialCases(token)) {\n                        report(\n                            node,\n                            new RuleError(\"ら抜き言葉を使用しています。\", {\n                                index: token.word_position\n                            })\n                        );\n                    }\n                });\n                // tokenのペアがない場合は無視する\n                if (tokens.length <= 1) {\n                    return;\n                }\n                tokens.reduce((prev, current) => {\n                    if (isTargetVerb(prev) && isRaWord(current)) {\n                        report(\n                            node,\n                            new RuleError(\"ら抜き言葉を使用しています。\", {\n                                index: current.word_position - 1\n                            })\n                        );\n                    }\n                    return current;\n                });\n            });\n        }\n    };\n};\n"],"file":"no-dropping-the-ra.js"}