{"version":3,"file":"hooks.js","sourceRoot":"","sources":["../../../lib/util/http/hooks.ts"],"names":[],"mappings":";;;AAKA,SAAS,YAAY,CAAC,QAAkB;IACtC,MAAM,EAAE,UAAU,EAAE,GAAG,QAAQ,CAAC;IAChC,MAAM,eAAe,GAAG,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC;IAE5E,OAAO,CACL,CAAC,UAAU,IAAI,GAAG,IAAI,UAAU,IAAI,eAAe,CAAC,IAAI,UAAU,KAAK,GAAG,CAC3E,CAAC;AACJ,CAAC;AAEY,QAAA,KAAK,GAAU;IAC1B,aAAa,EAAE;QACb,CAAC,QAAkB,EAAY,EAAE;YAC/B,IAAI,YAAY,CAAC,QAAQ,CAAC,EAAE;gBAC1B,QAAQ,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;aAC5B;YAED,OAAO,QAAQ,CAAC;QAClB,CAAC;KACF;CACF,CAAC","sourcesContent":["// Renovate issue: https://github.com/renovatebot/renovate/issues/12127\n// Got issue: https://github.com/sindresorhus/got/issues/1489\n// From here: https://github.com/sindresorhus/got/issues/1489#issuecomment-805485731\nimport type { Hooks, Response } from 'got';\n\nfunction isResponseOk(response: Response): boolean {\n  const { statusCode } = response;\n  const limitStatusCode = response.request.options.followRedirect ? 299 : 399;\n\n  return (\n    (statusCode >= 200 && statusCode <= limitStatusCode) || statusCode === 304\n  );\n}\n\nexport const hooks: Hooks = {\n  afterResponse: [\n    (response: Response): Response => {\n      if (isResponseOk(response)) {\n        response.request.destroy();\n      }\n\n      return response;\n    },\n  ],\n};\n"]}