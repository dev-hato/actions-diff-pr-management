{"version":3,"file":"user.js","sourceRoot":"","sources":["../../../../lib/modules/platform/github/user.ts"],"names":[],"mappings":";;;;AAAA,4CAAyC;AACzC,8EAAwD;AAGxD,MAAM,SAAS,GAAG,IAAI,UAAU,CAAC,UAAU,EAAE,CAAC;AAEvC,KAAK,UAAU,cAAc,CAClC,QAAgB,EAChB,KAAa;IAEb,IAAI;QACF,MAAM,QAAQ,GAAG,CACf,MAAM,SAAS,CAAC,OAAO,CACrB,QAAQ,GAAG,MAAM,EACjB;YACE,KAAK;SACN,CACF,CACF,CAAC,IAAI,CAAC;QACP,OAAO;YACL,QAAQ,EAAE,QAAQ,CAAC,KAAK;YACxB,IAAI,EAAE,QAAQ,CAAC,IAAI;SACpB,CAAC;KACH;IAAC,OAAO,GAAG,EAAE;QACZ,eAAM,CAAC,KAAK,CAAC,EAAE,GAAG,EAAE,EAAE,kCAAkC,CAAC,CAAC;QAC1D,MAAM,IAAI,KAAK,CAAC,8BAA8B,CAAC,CAAC;KACjD;AACH,CAAC;AArBD,wCAqBC;AAEM,KAAK,UAAU,YAAY,CAChC,QAAgB,EAChB,KAAa;IAEb,IAAI;QACF,MAAM,MAAM,GAAG,CACb,MAAM,SAAS,CAAC,OAAO,CAAsB,QAAQ,GAAG,aAAa,EAAE;YACrE,KAAK;SACN,CAAC,CACH,CAAC,IAAI,CAAC;QACP,OAAO,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK,IAAI,IAAI,CAAC;KAClC;IAAC,OAAO,GAAG,EAAE;QACZ,eAAM,CAAC,KAAK,CACV,kEAAkE,CACnE,CAAC;QACF,OAAO,IAAI,CAAC;KACb;AACH,CAAC;AAjBD,oCAiBC","sourcesContent":["import { logger } from '../../../logger';\nimport * as githubHttp from '../../../util/http/github';\nimport type { UserDetails } from './types';\n\nconst githubApi = new githubHttp.GithubHttp();\n\nexport async function getUserDetails(\n  endpoint: string,\n  token: string\n): Promise<UserDetails> {\n  try {\n    const userData = (\n      await githubApi.getJson<{ login: string; name: string }>(\n        endpoint + 'user',\n        {\n          token,\n        }\n      )\n    ).body;\n    return {\n      username: userData.login,\n      name: userData.name,\n    };\n  } catch (err) {\n    logger.debug({ err }, 'Error authenticating with GitHub');\n    throw new Error('Init: Authentication failure');\n  }\n}\n\nexport async function getUserEmail(\n  endpoint: string,\n  token: string\n): Promise<string | null> {\n  try {\n    const emails = (\n      await githubApi.getJson<{ email: string }[]>(endpoint + 'user/emails', {\n        token,\n      })\n    ).body;\n    return emails?.[0].email ?? null;\n  } catch (err) {\n    logger.debug(\n      'Cannot read user/emails endpoint on GitHub to retrieve gitAuthor'\n    );\n    return null;\n  }\n}\n"]}