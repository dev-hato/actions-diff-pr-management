{"version":3,"file":"get-locked.js","sourceRoot":"","sources":["../../../../../../../lib/modules/manager/npm/update/locked-dependency/yarn-lock/get-locked.ts"],"names":[],"mappings":";;;AAAA,qDAAkD;AAGlD,uEAAuE;AACvE,SAAgB,qBAAqB,CACnC,QAAkB,EAClB,OAAe,EACf,cAAsB;IAEtB,MAAM,GAAG,GAA2B,EAAE,CAAC;IACvC,IAAI;QACF,KAAK,MAAM,CAAC,iBAAiB,EAAE,KAAK,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE;YACjE,IAAI,SAAiB,CAAC;YACtB,IAAI,UAAkB,CAAC;YACvB,MAAM,KAAK,GAAG,iBAAiB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAC3C,uBAAuB;YACvB,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE;gBACtB,CAAC,SAAS,EAAE,UAAU,CAAC,GAAG,KAAK,CAAC;aACjC;iBAAM,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC7B,SAAS,GAAG,GAAG,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC3B,UAAU,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;aACvB;iBAAM;gBACL,eAAM,CAAC,KAAK,CACV,EAAE,iBAAiB,EAAE,KAAK,EAAE,EAC5B,8BAA8B,CAC/B,CAAC;gBACF,SAAS;aACV;YACD,IAAI,SAAS,KAAK,OAAO,IAAI,KAAK,EAAE,OAAO,KAAK,cAAc,EAAE;gBAC9D,GAAG,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,iBAAiB,EAAE,OAAO,EAAE,UAAU,EAAE,CAAC,CAAC;aAC7D;SACF;KACF;IAAC,OAAO,GAAG,EAAE,0BAA0B,CAAC;QACvC,eAAM,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE,EAAE,+BAA+B,CAAC,CAAC;KACvD;IACD,OAAO,GAAG,CAAC;AACb,CAAC;AAhCD,sDAgCC","sourcesContent":["import { logger } from '../../../../../../logger';\nimport type { YarnLock, YarnLockEntrySummary } from './types';\n\n// Finds matching dependencies withing a package lock file of sub-entry\nexport function getLockedDependencies(\n  yarnLock: YarnLock,\n  depName: string,\n  currentVersion: string\n): YarnLockEntrySummary[] {\n  const res: YarnLockEntrySummary[] = [];\n  try {\n    for (const [depNameConstraint, entry] of Object.entries(yarnLock)) {\n      let entryName: string;\n      let constraint: string;\n      const split = depNameConstraint.split('@');\n      // istanbul ignore else\n      if (split.length === 2) {\n        [entryName, constraint] = split;\n      } else if (split.length === 3) {\n        entryName = '@' + split[1];\n        constraint = split[2];\n      } else {\n        logger.debug(\n          { depNameConstraint, entry },\n          'Unexpected depNameConstraint'\n        );\n        continue;\n      }\n      if (entryName === depName && entry?.version === currentVersion) {\n        res.push({ entry, depNameConstraint, depName, constraint });\n      }\n    }\n  } catch (err) /* istanbul ignore next */ {\n    logger.warn({ err }, 'getLockedDependencies() error');\n  }\n  return res;\n}\n"]}