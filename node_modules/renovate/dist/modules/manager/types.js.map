{"version":3,"file":"types.js","sourceRoot":"","sources":["../../../lib/modules/manager/types.ts"],"names":[],"mappings":"","sourcesContent":["import type { ReleaseType } from 'semver';\nimport type {\n  MatchStringsStrategy,\n  RegexManagerTemplates,\n  UpdateType,\n  ValidationMessage,\n} from '../../config/types';\nimport type { ProgrammingLanguage } from '../../constants';\nimport type { ModuleApi, RangeStrategy, SkipReason } from '../../types';\nimport type { FileChange } from '../../util/git/types';\n\nexport type Result<T> = T | Promise<T>;\n\nexport interface ManagerData<T> {\n  managerData?: T;\n}\n\nexport interface ExtractConfig {\n  registryAliases?: Record<string, string>;\n  npmrc?: string;\n  npmrcMerge?: boolean;\n  skipInstalls?: boolean;\n}\n\nexport interface CustomExtractConfig\n  extends ExtractConfig,\n    RegexManagerTemplates {\n  autoReplaceStringTemplate?: string;\n  matchStrings: string[];\n  matchStringsStrategy?: MatchStringsStrategy;\n}\n\nexport interface UpdateArtifactsConfig {\n  isLockFileMaintenance?: boolean;\n  constraints?: Record<string, string>;\n  composerIgnorePlatformReqs?: string[];\n  currentValue?: string;\n  postUpdateOptions?: string[];\n  ignorePlugins?: boolean;\n  ignoreScripts?: boolean;\n  updateType?: UpdateType;\n  newValue?: string;\n  newVersion?: string;\n  newMajor?: number;\n  registryAliases?: Record<string, string>;\n}\n\nexport interface RangeConfig<T = Record<string, any>> extends ManagerData<T> {\n  currentValue?: string;\n  depName?: string;\n  depType?: string;\n  manager?: string | null;\n  packageJsonType?: 'app' | 'library';\n  rangeStrategy: RangeStrategy;\n}\n\nexport interface NpmLockFiles {\n  yarnLock?: string;\n  packageLock?: string;\n  shrinkwrapJson?: string;\n  pnpmShrinkwrap?: string;\n  npmLock?: string;\n  lockFiles?: string[];\n}\n\nexport interface PackageFile<T = Record<string, any>>\n  extends NpmLockFiles,\n    ManagerData<T> {\n  autoReplaceStringTemplate?: string;\n  hasYarnWorkspaces?: boolean;\n  constraints?: Record<string, string>;\n  extractedConstraints?: Record<string, string>;\n  datasource?: string;\n  registryUrls?: string[];\n  additionalRegistryUrls?: string[];\n  deps: PackageDependency[];\n  lernaClient?: string;\n  lernaPackages?: string[];\n  mavenProps?: Record<string, any>;\n  npmrc?: string;\n  packageFile?: string | null;\n  packageJsonName?: string;\n  packageJsonType?: 'app' | 'library';\n  packageFileVersion?: string;\n  parent?: string;\n  skipInstalls?: boolean;\n  yarnWorkspacesPackages?: string[] | string;\n  matchStrings?: string[];\n  matchStringsStrategy?: MatchStringsStrategy;\n}\n\nexport interface Package<T> extends ManagerData<T> {\n  currentValue?: string | null;\n  currentDigest?: string;\n  depName?: string;\n  depType?: string;\n  fileReplacePosition?: number;\n  groupName?: string;\n  lineNumber?: number;\n  packageName?: string | null;\n  target?: string;\n  versioning?: string;\n  dataType?: string;\n\n  // npm manager\n  bumpVersion?: ReleaseType | string;\n  npmPackageAlias?: boolean;\n  packageFileVersion?: string;\n  gitRef?: boolean;\n  sourceUrl?: string | null;\n  pinDigests?: boolean;\n  currentRawValue?: string;\n  major?: { enabled?: boolean };\n  prettyDepType?: string;\n}\n\nexport interface LookupUpdate {\n  bucket?: string;\n  branchName?: string;\n  commitMessageAction?: string;\n  isBump?: boolean;\n  isLockfileUpdate?: boolean;\n  isPin?: boolean;\n  isPinDigest?: boolean;\n  isRange?: boolean;\n  isRollback?: boolean;\n  isReplacement?: boolean;\n  newDigest?: string;\n  newMajor?: number;\n  newMinor?: number;\n  newName?: string;\n  newValue: string;\n  semanticCommitType?: string;\n  pendingChecks?: boolean;\n  pendingVersions?: string[];\n  newVersion?: string;\n  updateType?: UpdateType;\n  userStrings?: Record<string, string>;\n  checksumUrl?: string;\n  downloadUrl?: string;\n  releaseTimestamp?: any;\n}\n\nexport interface PackageDependency<T = Record<string, any>> extends Package<T> {\n  newValue?: string;\n  warnings?: ValidationMessage[];\n  commitMessageTopic?: string;\n  currentDigestShort?: string;\n  datasource?: string;\n  deprecationMessage?: string;\n  digestOneAndOnly?: boolean;\n  fixedVersion?: string;\n  currentVersion?: string;\n  lockedVersion?: string | null;\n  propSource?: string;\n  registryUrls?: string[] | null;\n  rangeStrategy?: RangeStrategy;\n  skipReason?: SkipReason;\n  sourceLine?: number;\n  newVersion?: string;\n  updates?: LookupUpdate[];\n  replaceString?: string;\n  autoReplaceStringTemplate?: string;\n  depIndex?: number;\n  editFile?: string;\n  separateMinorPatch?: boolean;\n  extractVersion?: string;\n  isInternal?: boolean;\n}\n\nexport interface Upgrade<T = Record<string, any>>\n  extends Package<T>,\n    NpmLockFiles {\n  isLockfileUpdate?: boolean;\n  currentRawValue?: any;\n  depGroup?: string;\n  name?: string;\n  newDigest?: string;\n  newFrom?: string;\n  newMajor?: number;\n  newName?: string;\n  newValue?: string;\n  packageFile?: string;\n  rangeStrategy?: RangeStrategy;\n  newVersion?: string;\n  updateType?: UpdateType;\n  version?: string;\n  isLockFileMaintenance?: boolean;\n  isRemediation?: boolean;\n  isVulnerabilityAlert?: boolean;\n}\n\nexport interface ArtifactError {\n  lockFile?: string;\n  stderr?: string;\n}\n\nexport interface UpdateArtifactsResult {\n  artifactError?: ArtifactError;\n  file?: FileChange;\n}\n\nexport interface UpdateArtifact {\n  packageFileName: string;\n  updatedDeps: PackageDependency[];\n  newPackageFileContent: string;\n  config: UpdateArtifactsConfig;\n}\n\nexport interface UpdateDependencyConfig<T = Record<string, any>> {\n  fileContent: string;\n  upgrade: Upgrade<T>;\n}\n\nexport interface BumpPackageVersionResult {\n  bumpedContent: string | null;\n}\n\nexport interface UpdateLockedConfig {\n  packageFile: string;\n  packageFileContent?: string;\n  lockFile: string;\n  lockFileContent?: string;\n  depName: string;\n  currentVersion?: string;\n  newVersion: string;\n  allowParentUpdates?: boolean;\n  allowHigherOrRemoved?: boolean;\n}\n\nexport interface UpdateLockedResult {\n  status: 'unsupported' | 'updated' | 'already-updated' | 'update-failed';\n  files?: Record<string, string>;\n}\n\nexport interface GlobalManagerConfig {\n  npmrc?: string;\n  npmrcMerge?: boolean;\n}\n\nexport interface ManagerApi extends ModuleApi {\n  defaultConfig: Record<string, unknown>;\n  language?: ProgrammingLanguage;\n  supportsLockFileMaintenance?: boolean;\n\n  supportedDatasources: string[];\n\n  bumpPackageVersion?(\n    content: string,\n    currentValue: string,\n    bumpVersion: ReleaseType | string\n  ): Result<BumpPackageVersionResult>;\n\n  detectGlobalConfig?(): Result<GlobalManagerConfig>;\n\n  extractAllPackageFiles?(\n    config: ExtractConfig,\n    files: string[]\n  ): Result<PackageFile[] | null>;\n\n  extractPackageFile?(\n    content: string,\n    packageFile?: string,\n    config?: ExtractConfig\n  ): Result<PackageFile | null>;\n\n  getRangeStrategy?(config: RangeConfig): RangeStrategy;\n\n  updateArtifacts?(\n    updateArtifact: UpdateArtifact\n  ): Result<UpdateArtifactsResult[] | null>;\n\n  updateDependency?(\n    updateDependencyConfig: UpdateDependencyConfig\n  ): Result<string | null>;\n\n  updateLockedDependency?(\n    config: UpdateLockedConfig\n  ): Result<UpdateLockedResult>;\n}\n\n// TODO: name and properties used by npm manager\nexport interface PostUpdateConfig<T = Record<string, any>>\n  extends Record<string, any>,\n    ManagerData<T> {\n  updatedPackageFiles?: FileChange[];\n  postUpdateOptions?: string[];\n  skipInstalls?: boolean;\n  ignoreScripts?: boolean;\n\n  packageFile?: string;\n\n  upgrades: Upgrade[];\n  npmLock?: string;\n  yarnLock?: string;\n  branchName: string;\n  reuseExistingBranch?: boolean;\n}\n"]}