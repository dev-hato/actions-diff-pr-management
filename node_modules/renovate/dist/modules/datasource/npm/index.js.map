{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../lib/modules/datasource/npm/index.ts"],"names":[],"mappings":";;;;AAAA,4EAAsD;AACtD,8CAA2C;AAE3C,qCAA8B;AAC9B,+BAAsC;AAEtC,6BAAkD;AAAzC,oGAAA,aAAa,OAAA;AAAE,iGAAA,UAAU,OAAA;AAClC,iCAAmC;AAA1B,iGAAA,QAAQ,OAAA;AAEjB,MAAa,aAAc,SAAQ,uBAAU;IAS3C;QACE,KAAK,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;QAPR,0BAAqB,GAAG,IAAI,CAAC;QAE7B,qBAAgB,GAAG,OAAO,CAAC;QAE3B,sBAAiB,GAAG,aAAa,CAAC,EAAE,CAAC;IAIvD,CAAC;IAED,KAAK,CAAC,WAAW,CAAC,EAChB,WAAW,EACX,WAAW,GACO;QAClB,qBAAqB;QACrB,IAAI,CAAC,WAAW,EAAE;YAChB,OAAO,IAAI,CAAC;SACb;QAED,MAAM,GAAG,GAAG,MAAM,IAAA,mBAAa,EAAC,IAAI,CAAC,IAAI,EAAE,WAAW,EAAE,WAAW,CAAC,CAAC;QACrE,IAAI,GAAG,EAAE;YACP,GAAG,CAAC,IAAI,KAAR,GAAG,CAAC,IAAI,GAAK,GAAG,CAAC,WAAW,CAAC,EAAC;YAC9B,OAAO,GAAG,CAAC,WAAW,CAAC,CAAC;SACzB;QACD,OAAO,GAAG,CAAC;IACb,CAAC;;AA5BH,sCA6BC;AA5BiB,gBAAE,GAAG,WAAE,CAAC","sourcesContent":["import * as npmVersioning from '../../versioning/npm';\nimport { Datasource } from '../datasource';\nimport type { GetReleasesConfig, ReleaseResult } from '../types';\nimport { id } from './common';\nimport { getDependency } from './get';\n\nexport { resetMemCache, resetCache } from './get';\nexport { setNpmrc } from './npmrc';\n\nexport class NpmDatasource extends Datasource {\n  static readonly id = id;\n\n  override readonly customRegistrySupport = true;\n\n  override readonly registryStrategy = 'first';\n\n  override readonly defaultVersioning = npmVersioning.id;\n\n  constructor() {\n    super(NpmDatasource.id);\n  }\n\n  async getReleases({\n    packageName,\n    registryUrl,\n  }: GetReleasesConfig): Promise<ReleaseResult | null> {\n    // istanbul ignore if\n    if (!registryUrl) {\n      return null;\n    }\n\n    const res = await getDependency(this.http, registryUrl, packageName);\n    if (res) {\n      res.tags ||= res['dist-tags'];\n      delete res['dist-tags'];\n    }\n    return res;\n  }\n}\n"]}