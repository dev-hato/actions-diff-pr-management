{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../lib/modules/versioning/ubuntu/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { regEx } from '../../../util/regex';\nimport { DistroInfo } from '../distro';\nimport type { NewValueConfig, VersioningApi } from '../types';\n\nexport const id = 'ubuntu';\nexport const displayName = 'Ubuntu';\nexport const urls = [\n  'https://changelogs.ubuntu.com/meta-release',\n  'https://debian.pages.debian.net/distro-info-data/ubuntu.csv',\n];\nexport const supportsRanges = false;\n\nconst di = new DistroInfo('data/ubuntu-distro-info.json');\n\n// validation\n\nfunction isValid(input: string): boolean {\n  return (\n    (typeof input === 'string' &&\n      regEx(/^(0[4-5]|[6-9]|[1-9][0-9])\\.[0-9][0-9](\\.[0-9]{1,2})?$/).test(\n        input\n      )) ||\n    di.isCodename(input)\n  );\n}\n\nfunction isVersion(input: string): boolean {\n  return isValid(input);\n}\n\nfunction isCompatible(version: string, _current?: string): boolean {\n  return isValid(version);\n}\n\nfunction isSingleVersion(version: string): boolean {\n  return isValid(version);\n}\n\nfunction isStable(version: string): boolean {\n  const ver = di.getVersionByCodename(version);\n  if (!isValid(ver)) {\n    return false;\n  }\n\n  const match = ver.match(regEx(/^\\d+.\\d+/));\n\n  if (!di.isReleased(match ? match[0] : ver)) {\n    return false;\n  }\n\n  return regEx(/^\\d?[02468]\\.04/).test(ver);\n}\n\n// digestion of version\n\nfunction getMajor(version: string): null | number {\n  const ver = di.getVersionByCodename(version);\n  if (isValid(ver)) {\n    const [major] = ver.split('.');\n    return parseInt(major, 10);\n  }\n  return null;\n}\n\nfunction getMinor(version: string): null | number {\n  const ver = di.getVersionByCodename(version);\n  if (isValid(ver)) {\n    const [, minor] = ver.split('.');\n    return parseInt(minor, 10);\n  }\n  return null;\n}\n\nfunction getPatch(version: string): null | number {\n  const ver = di.getVersionByCodename(version);\n  if (isValid(ver)) {\n    const [, , patch] = ver.split('.');\n    return patch ? parseInt(patch, 10) : null;\n  }\n  return null;\n}\n\n// comparison\n\nfunction equals(version: string, other: string): boolean {\n  const ver = di.getVersionByCodename(version);\n  const otherVer = di.getVersionByCodename(other);\n  return isVersion(ver) && isVersion(otherVer) && ver === otherVer;\n}\n\nfunction isGreaterThan(version: string, other: string): boolean {\n  const xMajor = getMajor(version) ?? 0;\n  const yMajor = getMajor(other) ?? 0;\n  if (xMajor > yMajor) {\n    return true;\n  }\n  if (xMajor < yMajor) {\n    return false;\n  }\n\n  const xMinor = getMinor(version) ?? 0;\n  const yMinor = getMinor(other) ?? 0;\n  if (xMinor > yMinor) {\n    return true;\n  }\n  if (xMinor < yMinor) {\n    return false;\n  }\n\n  const xPatch = getPatch(version) ?? 0;\n  const yPatch = getPatch(other) ?? 0;\n  return xPatch > yPatch;\n}\n\nfunction getSatisfyingVersion(\n  versions: string[],\n  range: string\n): string | null {\n  return versions.find((version) => equals(version, range)) ? range : null;\n}\n\nfunction minSatisfyingVersion(\n  versions: string[],\n  range: string\n): string | null {\n  return getSatisfyingVersion(versions, range);\n}\n\nfunction getNewValue({\n  currentValue,\n  rangeStrategy,\n  currentVersion,\n  newVersion,\n}: NewValueConfig): string {\n  if (di.isCodename(currentValue)) {\n    return di.getCodenameByVersion(newVersion);\n  }\n  return di.getVersionByCodename(newVersion);\n}\n\nfunction sortVersions(version: string, other: string): number {\n  if (equals(version, other)) {\n    return 0;\n  }\n  if (isGreaterThan(version, other)) {\n    return 1;\n  }\n  return -1;\n}\n\nfunction matches(version: string, range: string): boolean {\n  return equals(version, range);\n}\n\nexport const api: VersioningApi = {\n  isCompatible,\n  isSingleVersion,\n  isStable,\n  isValid,\n  isVersion,\n\n  getMajor,\n  getMinor,\n  getPatch,\n\n  equals,\n  isGreaterThan,\n  getSatisfyingVersion,\n  minSatisfyingVersion,\n  getNewValue,\n  sortVersions,\n\n  matches,\n};\n\nexport default api;\n"]}