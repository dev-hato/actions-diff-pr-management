{"version":3,"file":"bucket.js","sourceRoot":"","sources":["../../../../../lib/workers/repository/process/lookup/bucket.ts"],"names":[],"mappings":";;;AAQA,SAAgB,SAAS,CACvB,MAAoB,EACpB,cAAsB,EACtB,UAAkB,EAClB,UAAyB;IAEzB,MAAM,EAAE,kBAAkB,EAAE,qBAAqB,EAAE,kBAAkB,EAAE,GACrE,MAAM,CAAC;IACT,IAAI,CAAC,kBAAkB,EAAE;QACvB,OAAO,QAAQ,CAAC;KACjB;IACD,MAAM,SAAS,GAAG,UAAU,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;IACtD,MAAM,OAAO,GAAG,UAAU,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;IAChD,qBAAqB;IACrB,IAAI,OAAO,KAAK,IAAI,EAAE;QACpB,OAAO,IAAI,CAAC;KACb;IACD,IAAI,SAAS,KAAK,OAAO,EAAE;QACzB,IAAI,qBAAqB,EAAE;YACzB,OAAO,SAAS,OAAO,EAAE,CAAC;SAC3B;QACD,OAAO,OAAO,CAAC;KAChB;IACD,IAAI,kBAAkB,EAAE;QACtB,IACE,UAAU,CAAC,QAAQ,CAAC,cAAc,CAAC,KAAK,UAAU,CAAC,QAAQ,CAAC,UAAU,CAAC,EACvE;YACA,OAAO,OAAO,CAAC;SAChB;QACD,OAAO,OAAO,CAAC;KAChB;IACD,OAAO,WAAW,CAAC;AACrB,CAAC;AAhCD,8BAgCC","sourcesContent":["import type { VersioningApi } from '../../../../modules/versioning/types';\n\nexport interface BucketConfig {\n  separateMajorMinor?: boolean;\n  separateMultipleMajor?: boolean;\n  separateMinorPatch?: boolean;\n}\n\nexport function getBucket(\n  config: BucketConfig,\n  currentVersion: string,\n  newVersion: string,\n  versioning: VersioningApi\n): string | null {\n  const { separateMajorMinor, separateMultipleMajor, separateMinorPatch } =\n    config;\n  if (!separateMajorMinor) {\n    return 'latest';\n  }\n  const fromMajor = versioning.getMajor(currentVersion);\n  const toMajor = versioning.getMajor(newVersion);\n  // istanbul ignore if\n  if (toMajor === null) {\n    return null;\n  }\n  if (fromMajor !== toMajor) {\n    if (separateMultipleMajor) {\n      return `major-${toMajor}`;\n    }\n    return 'major';\n  }\n  if (separateMinorPatch) {\n    if (\n      versioning.getMinor(currentVersion) === versioning.getMinor(newVersion)\n    ) {\n      return 'patch';\n    }\n    return 'minor';\n  }\n  return 'non-major';\n}\n"]}