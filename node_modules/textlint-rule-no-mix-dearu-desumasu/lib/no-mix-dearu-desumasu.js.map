{"version":3,"sources":["../src/no-mix-dearu-desumasu.js"],"names":["PreferTypes","DESUMASU","DEARU","defaultOptions","preferInHeader","preferInBody","preferInList","strict","module","exports","noMixedDearuDesumasu","context","options","Syntax","getSource","helper","RuleHelper","ignoreManager","IgnoreNodeManager","isStrict","undefined","bodyChecker","BodyMixedChecker","preferDesumasu","preferDearu","headerChecker","HeaderMixedChecker","listChecker","ListMixedChecker","Header","node","text","check","ListItem","Paragraph","ignoredNodeTypes","Link","Code","Image","BlockQuote","Emphasis","isChildNode","ignoreChildrenByTypes","Document","Promise","all","checkout"],"mappings":"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","sourcesContent":["// LICENSE : MIT\n\"use strict\";\nimport { RuleHelper, IgnoreNodeManager } from \"textlint-rule-helper\";\nimport BodyMixedChecker from \"./BodyMixedChecker\";\nimport HeaderMixedChecker from \"./HeaderMixedChecker\";\nimport ListMixedChecker from \"./ListMixedChecker\";\nexport const PreferTypes = {\n    DESUMASU: \"ですます\",\n    DEARU: \"である\"\n};\n// デフォルトでその項目で多く出現している方を優先します。\n// 明示的にpreferの設定した場合は、そちらを優先した内容をエラーとして表示します。\nconst defaultOptions = {\n    preferInHeader: \"\", // \"である\" or \"ですます\"\n    preferInBody: \"\", // \"である\" or \"ですます\"\n    preferInList: \"\", // \"である\" or \"ですます\"\n    // 文末以外でも、敬体(ですます調)と常体(である調)を厳しくチェックするかどうか\n    strict: false\n};\n\nmodule.exports = function noMixedDearuDesumasu(context, options = defaultOptions) {\n    const { Syntax, getSource } = context;\n    const helper = new RuleHelper(context);\n    const ignoreManager = new IgnoreNodeManager();\n    const isStrict = options.strict !== undefined ? options.strict : defaultOptions.strict;\n    const bodyChecker = new BodyMixedChecker(context, {\n        preferDesumasu: options.preferInBody === PreferTypes.DESUMASU,\n        preferDearu: options.preferInBody === PreferTypes.DEARU,\n        isStrict\n    });\n    const headerChecker = new HeaderMixedChecker(context, {\n        preferDesumasu: options.preferInHeader === PreferTypes.DESUMASU,\n        preferDearu: options.preferInHeader === PreferTypes.DEARU,\n        isStrict\n    });\n    const listChecker = new ListMixedChecker(context, {\n        preferDesumasu: options.preferInList === PreferTypes.DESUMASU,\n        preferDearu: options.preferInList === PreferTypes.DEARU,\n        isStrict\n    });\n    return {\n        // 見出し\n        [Syntax.Header](node) {\n            const text = getSource(node);\n            headerChecker.check(node, text);\n        },\n        // 箇条書き\n        [Syntax.ListItem](node) {\n            const text = getSource(node);\n            listChecker.check(node, text);\n        },\n        // 本文\n        [Syntax.Paragraph](node) {\n            const ignoredNodeTypes = [Syntax.Link, Syntax.Code, Syntax.Image, Syntax.BlockQuote, Syntax.Emphasis];\n            // 無視リストのTypeが親にある場合は無視する\n            if (helper.isChildNode(node, ignoredNodeTypes)) {\n                return;\n            }\n            // 見出しと箇条書きは別途チェックするので Header > Str などは無視する\n            if (helper.isChildNode(node, [Syntax.Header, Syntax.ListItem])) {\n                return;\n            }\n            // childrenに無視するtypeがいた場合は無視リストに加える\n            ignoreManager.ignoreChildrenByTypes(node, ignoredNodeTypes);\n            // check\n            const text = getSource(node);\n            bodyChecker.check(node, text);\n        },\n        [Syntax.Document + \":exit\"]() {\n            return Promise.all([\n                bodyChecker.checkout(ignoreManager),\n                headerChecker.checkout(ignoreManager),\n                listChecker.checkout(ignoreManager)\n            ]);\n        }\n    };\n};\n"],"file":"no-mix-dearu-desumasu.js"}